<!DOCTYPE aesl-source>
<network>


<!--list of global events-->


<!--list of constants-->


<!--show keywords state-->
<keywords flag="true"/>


<!--node thymio-II-->
<node nodeId="1" name="thymio-II">var compteur2 = 0
var compteur3 = 0
var compteur4 = 0
var compteur5 = 0
var compteur6 = 0
var compteur7 = 0
var compteur8 = 0

var state = 0

###################################################################################################################

onevent button.forward

timer.period[0] = 50
timer.period[1] = 100
motor.left.target = 100
motor.right.target = 100
state = 1

####################################################################################################################

onevent timer0
if prox.horizontal[0] != 0 and prox.horizontal[1] != 0 and prox.horizontal[2] != 0 and prox.horizontal[3] == 0 and prox.horizontal[4] == 0 then

	state = 2
	
#####
    #
##  #
 #  #

elseif prox.horizontal[0] == 0 and prox.horizontal[1] == 0 and prox.horizontal[2] != 0 and prox.horizontal[3] != 0 and prox.horizontal[4] != 0  then

	state = 3

#####
#
#  ##
#  #

elseif prox.horizontal[0] == 0 and prox.horizontal[1] != 0 and prox.horizontal[2] != 0 and prox.horizontal[3] != 0 and prox.horizontal[4] == 0  then

	state = 4

######

##  ##
 #  #

#a faire
elseif prox.horizontal[0] == 0 and prox.horizontal[1] == 0 and prox.horizontal[2] == 0 and prox.horizontal[3] == 0 and prox.horizontal[4] == 0  then

	state = 5
	
 #	#
##  ##

##  ##
 #  #

elseif prox.horizontal[0] != 0 and prox.horizontal[1] == 0 and prox.horizontal[2] == 0 and prox.horizontal[3] == 0 and prox.horizontal[4] == 0  then

	state = 6
	
#  #
#  ##
#
#  ##
#  #

elseif prox.horizontal[0] == 0 and prox.horizontal[1] == 0 and prox.horizontal[2] == 0 and prox.horizontal[3] == 0 and prox.horizontal[4] != 0  then
	
	state = 7

 #  #
##  #
	#
##  #
 #  #

elseif prox.horizontal[0] != 0 and prox.horizontal[1] != 0 and prox.horizontal[2] != 0 and prox.horizontal[3] != 0 and prox.horizontal[4] != 0  then
	
	state = 8

end 
	
if  prox.horizontal[0] > 2500 and prox.horizontal[4] > 2500 then

	motor.left.target = 100
	motor.right.target = 100
end

####################################################################################################################

onevent timer1

if  state == 1 then
	
	motor.left.target = 100
	motor.right.target = 100

######################################

elseif  state == 2 then
	
	compteur2++
	if  compteur2 &lt; 10 then
	
		motor.left.target = 100
		motor.right.target = 100
	
	elseif compteur2 > 10 then

		motor.left.target = 250
		motor.right.target = 80
	end 	
		
	if  compteur2 >= 41 then
		compteur2 = 0
		state = 0
	end
	
elseif  state == 3 then

	compteur3++

######################################

elseif  state == 4 then

	compteur4++

######################################

elseif  state == 5 then

	compteur5++

######################################

elseif  state == 6 then

	compteur6++

######################################

elseif  state == 7 then

	compteur7++
	
######################################

elseif  state == 7 then

	compteur8++
		
end

########################################################################################################################

onevent button.backward

motor.left.target = 0
motor.right.target = 0
timer.period[0] = 0
timer.period[1] = 0
compteur2 = 0
compteur3 = 0
compteur4 = 0
compteur5 = 0
compteur6 = 0
compteur7 = 0
state = 0</node>


</network>
